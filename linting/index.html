
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://ageorgoulas.github.io/pyproject-toml/linting/">
      
      
        <link rel="prev" href="../packaging/">
      
      
        <link rel="next" href="../type_checking/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.18">
    
    
      
        <title>Linting - A tour of pyproject.toml</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e37652d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#linting" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="A tour of pyproject.toml" class="md-header__button md-logo" aria-label="A tour of pyproject.toml" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            A tour of pyproject.toml
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Linting
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="A tour of pyproject.toml" class="md-nav__button md-logo" aria-label="A tour of pyproject.toml" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    A tour of pyproject.toml
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Setting up
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../packaging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Packaging
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Linting
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Linting
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#install-the-linter" class="md-nav__link">
    <span class="md-ellipsis">
      Install the linter
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-the-linter-and-address-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Run the linter and address issues
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configure-linting" class="md-nav__link">
    <span class="md-ellipsis">
      Configure linting
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#further-resources" class="md-nav__link">
    <span class="md-ellipsis">
      Further resources
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../type_checking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Type checking
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../appendix/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Appendix: Converting existing configurations
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#install-the-linter" class="md-nav__link">
    <span class="md-ellipsis">
      Install the linter
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-the-linter-and-address-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Run the linter and address issues
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configure-linting" class="md-nav__link">
    <span class="md-ellipsis">
      Configure linting
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#further-resources" class="md-nav__link">
    <span class="md-ellipsis">
      Further resources
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="linting">Linting</h1>
<p>As codebases become larger, it is easier for mistakes to creep in.
<strong>Linters</strong> are tools that check the code for signs of potential problems,
like unused variables or uncommon usage patterns.</p>
<p>There are numerous linters for Python, and many of them can be configured
through <code>pyproject.toml</code>.
For this tutorial, we will use Ruff, a relatively recent suite of linters
and formatters tools, which draws inspiration from previous tools.</p>
<h2 id="install-the-linter">Install the linter</h2>
<p>Like many Python analysis tools, Ruff is available as a package we an install.</p>
<p>The linter is an optional dependency: we need it while developing,
but it's not something we want our users to install. We'll therefore put it
in a separate category of development-only requirements.</p>
<p>Add the following to your <code>pyproject.toml</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">[project.optional-dependencies]</span>
<span class="n">dev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;ruff&quot;</span><span class="p">,</span>
<span class="p">]</span>
</code></pre></div>
<div class="admonition example">
<p class="admonition-title">Install the new dependency</p>
<p>Run <code>python -m pip install .[dev]</code></p>
<p>This will install your core package along with the <code>dev</code> "extra".
You should see that <code>pip</code> is searching for <code>ruff</code> and its dependencies.</p>
</div>
<h2 id="run-the-linter-and-address-issues">Run the linter and address issues</h2>
<p>Now that it's installed, we can use the linter.</p>
<div class="admonition example">
<p class="admonition-title">Run the linter</p>
<p>Run <code>python -m ruff check src</code> from the root of your project.</p>
<p>Look at the error reported about an unused variable.
The error is correctly identified, but the solution suggested is
perhaps not the best... Address the error however you think is best,
and rerun <code>ruff</code> to check that it reports no problems.</p>
</div>
<h2 id="configure-linting">Configure linting</h2>
<p><code>ruff</code> uses a default set of rules when checking your code, but it can be
customized to add or remove from that rulset. This is useful when you want
to be stricter or, conversely, you want to ignore a particular rule.</p>
<p>Add the following section in <code>pyproject.toml</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">[tool.ruff.lint]</span>
<span class="n">select</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;E&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;F&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;B&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;SIM&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;I&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;ARG&quot;</span>
<span class="p">]</span>
</code></pre></div>
<p>The above configuration specifies the set of rules to use.</p>
<div class="admonition example">
<p class="admonition-title">Try the new configuration</p>
<p>Rerun the linter. You should now seem some additional errors.</p>
<p>Each error is accompanied by a code like <code>UP015</code>, indicating the rule
it violates. The rules are grouped in categories starting with the
same letter. For example, <code>I</code> indicates rules related to the ordering of
imports, while <code>ARG</code> rules have to do with function arguments.
With the above configuration, we have asked Ruff to check the categories
<code>E</code>, <code>F</code> and so on.</p>
<p>In our case, the additional category detected a bug: we are not using
one of the function's arguments. Assuming this is unintentional,
change the function body to fix the bug (use the <code>y</code> argument however
you want).</p>
<p>Rerun <code>ruff</code> to check that the errors are gone.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Exclude files from linting</p>
<p>Ruff will try to detect all relevant files to check, but sometimes
you may want to exclude some files from it. For example, when you
installed your package, <code>pip</code> may have created a <code>build</code> directory
with a copy of your code. Running Ruff on those files will generally
report the same errors as in <code>src</code>, which is redundant.</p>
<p>We have been working around this by restricting the folder that <code>ruff</code>
looks at through passing the extra command-line argument <code>src</code>,
but it can be easier to configure this in <code>pyproject.toml</code>.</p>
<p>Add the following entry in the file, below the previous configuration:
<div class="highlight"><pre><span></span><code><span class="k">[tool.ruff.lint]</span>
<span class="p">...</span>
<span class="n">exclude</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;build/**&quot;</span><span class="p">]</span>
</code></pre></div></p>
<p>Now you can simply run <code>python -m ruff check</code>, and the <code>build</code> diretory
will be ignored. This also gives you finer-grained control, since
you can exclude individual files.</p>
</div>
<h2 id="further-resources">Further resources</h2>
<ul>
<li>The Ruff documentation describes the different <a href="https://docs.astral.sh/ruff/rules/">rules</a> you can
select from.</li>
<li>It also explains how to <a href="https://docs.astral.sh/ruff/linter/#error-suppression">ignore a rule</a>, either entirely
or for individual lines or files.</li>
<li><a href="https://flake8.pycqa.org/en/latest/index.html">Flake8</a> is another popular linter which can be customized
similarly.</li>
<li>Ruff can also be used for <a href="https://docs.astral.sh/ruff/formatter/">automatic formatting</a>
of your Python code, enforcing rules like line length and naming conventions.
Other formatters include <a href="https://black.readthedocs.io/en/stable/">black</a> and <a href="https://pycodestyle.pycqa.org/en/latest/">pycodestyle</a>.</li>
</ul>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["content.tabs.link"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.92b07e13.min.js"></script>
      
    
  </body>
</html>